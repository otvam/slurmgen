#!/bin/bash

#SBATCH --job-name="test"
#SBATCH --output="slurm_output/test.log"
#SBATCH --time="23:00:00"
#SBATCH --nodes="1"
#SBATCH --ntasks-per-node="16"
#SBATCH --mem="64G"

echo "================================= SLURM START"

echo "==================== PARAM"
echo "TAG          : test"
echo "LOG FILE     : slurm_output/test.log"
echo "SLURM FILE   : slurm_output/test.slm"

echo "==================== INFO"
echo "HOSTNAME : `hostname`"
echo "DATE : `date`"

echo "==================== SLURM"
echo "JOB ID       : $SLURM_JOB_ID"
echo "JOB NAME     : $SLURM_JOB_NAME"
echo "JOB NODE     : $SLURM_JOB_NODELIST"

echo "==================== FOLDER DELETE"
rm -rf "data_input"
rm -rf "data_output"

echo "==================== FOLDER CREATE"
mkdir -p "data_input"
mkdir -p "data_output"

echo "==================== ENV VAR"
export PYTHONUNBUFFERED="1"
export CONFIGHPC="1"

echo "==================== CONDA LOAD"
source "conda.sh"

echo "==================== CONDA ACTIVATE"
conda activate "envname"

echo "==================== RUN: python"
python "run_solve.py" "arg_1" "arg_2"

echo "==================== RUN: perl"
perl "run_solve.pl" "arg_1" "arg_2"

echo "======================================== SLURM END"
exit 0
